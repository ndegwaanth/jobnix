<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - JobNix</title>
    {% load static %}
    <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
</head>
<body class="dashboard-youth" data-user-theme="{{ user.theme_preference|default:'light' }}">
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <img src="{% static 'icons/logo.png' %}" alt="JobNix Logo" style="width: 32px; height: 32px; margin-right: 8px; object-fit: contain;">
                <span>Job<span class="accent">Nix</span></span>
            </div>
        </div>
        <nav class="sidebar-nav">
            <a href="{% url 'accounts:dashboard' %}" class="nav-item active">
                <i class="fas fa-home"></i>
                <span>Dashboard</span>
            </a>
            <a href="{% url 'jobs:job_list' %}" class="nav-item">
                <i class="fas fa-briefcase"></i>
                <span>Browse Jobs</span>
            </a>
            <a href="{% url 'education:course_list' %}" class="nav-item">
                <i class="fas fa-graduation-cap"></i>
                <span>Courses</span>
            </a>
            <a href="{% url 'accounts:applications_list' %}" class="nav-item">
                <i class="fas fa-file-alt"></i>
                <span>My Applications</span>
            </a>
            <a href="{% url 'education:my_courses' %}" class="nav-item">
                <i class="fas fa-book"></i>
                <span>My Courses</span>
            </a>
            <a href="{% url 'accounts:saved_jobs' %}" class="nav-item">
                <i class="fas fa-bookmark"></i>
                <span>Saved Jobs</span>
            </a>
            <a href="{% url 'accounts:certificates' %}" class="nav-item">
                <i class="fas fa-certificate"></i>
                <span>Certificates</span>
            </a>
            <a href="{% url 'accounts:notifications' %}" class="nav-item">
                <i class="fas fa-bell"></i>
                <span>Notifications</span>
            </a>
            <a href="{% url 'accounts:messages' %}" class="nav-item">
                <i class="fas fa-envelope"></i>
                <span>Messages</span>
            </a>
            <a href="{% url 'accounts:profile_analytics' %}" class="nav-item">
                <i class="fas fa-chart-line"></i>
                <span>Analytics</span>
            </a>
            <a href="{% url 'accounts:profile' %}" class="nav-item">
                <i class="fas fa-user"></i>
                <span>Profile</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <a href="{% url 'accounts:logout' %}" class="nav-item logout">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Top Bar -->
        <header class="topbar">
            <div class="topbar-left">
                <h1>Welcome back, {{ user.first_name|default:user.username }}!</h1>
                <p>Ready to find your next opportunity?</p>
            </div>
            <div class="topbar-right">
                <a href="{% url 'accounts:notifications' %}" class="notifications">
                    <i class="fas fa-bell"></i>
                    <span class="badge">{{ unread_notifications|default:"0" }}</span>
                </a>
                <div class="user-menu">
                    {% if profile and profile.profile_picture %}
                        <img src="{{ profile.profile_picture.url }}" alt="User" class="avatar">
                    {% else %}
                        <img src="https://ui-avatars.com/api/?name={{ user.first_name|default:user.username }}&background=6366f1&color=fff" alt="User" class="avatar">
                    {% endif %}
                    <span>{{ user.first_name|default:user.username }}</span>
                </div>
                <div class="theme-switcher" style="margin-left: 1rem;">
                    <button onclick="toggleTheme()" class="btn-icon" title="Toggle Theme">
                        <i class="fas fa-moon" id="theme-icon"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Dashboard Content -->
        <div class="dashboard-grid">
            <!-- Stats Cards -->
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);">
                    <i class="fas fa-briefcase"></i>
                </div>
                <div class="stat-info">
                    <h3>{{ total_applications|default:"0" }}</h3>
                    <p>Jobs Applied</p>
                    <span class="stat-change positive">Total applications</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, #ec4899 0%, #f43f5e 100%);">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="stat-info">
                    <h3>{{ active_applications|default:"0" }}</h3>
                    <p>Active Applications</p>
                    <span class="stat-change">Pending review</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <div class="stat-info">
                    <h3>{{ completed_courses|default:"0" }}</h3>
                    <p>Courses Completed</p>
                    <span class="stat-change positive">{{ total_enrollments|default:"0" }} enrolled</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                    <i class="fas fa-bookmark"></i>
                </div>
                <div class="stat-info">
                    <h3>{{ saved_jobs_count|default:"0" }}</h3>
                    <p>Saved Jobs</p>
                    <span class="stat-change positive">Bookmarked</span>
                </div>
            </div>

            <!-- Recommended Jobs -->
            <div class="dashboard-card large">
                <div class="card-header">
                    <h2><i class="fas fa-sparkles"></i> Recommended Jobs</h2>
                    <a href="{% url 'jobs:job_list' %}" class="view-all">View All <i class="fas fa-arrow-right"></i></a>
                </div>
                <div class="jobs-list">
                    {% if recommended_jobs %}
                        {% for job in recommended_jobs %}
                        <div class="job-item">
                            <div class="job-company">
                                <div class="company-logo">{{ job.company_name|first|upper }}</div>
                                <div class="company-info">
                                    <h3>{{ job.job_title }}</h3>
                                    <p>{{ job.company_name }} • {{ job.location }} • {{ job.work_type|title }} • {{ job.salary_display_text }}</p>
                                </div>
                            </div>
                            <div class="job-match">
                                <div class="match-badge">Recommended</div>
                                <a href="{% url 'jobs:job_detail' job.id %}" class="btn-apply" style="text-decoration: none; display: inline-block;">Apply Now</a>
                            </div>
                        </div>
                        {% endfor %}
                    {% elif applications %}
                        {% for application in applications|slice:":3" %}
                        <div class="job-item">
                            <div class="job-company">
                                <div class="company-logo">{{ application.job.company_name|first|upper }}</div>
                                <div class="company-info">
                                    <h3>{{ application.job.job_title }}</h3>
                                    <p>{{ application.job.company_name }} • {{ application.job.location }} • {{ application.job.salary_display_text }}</p>
                                </div>
                            </div>
                            <div class="job-match">
                                {% if application.match_score %}
                                <div class="match-badge">{{ application.match_score|floatformat:0 }}% Match</div>
                                {% endif %}
                                <a href="{% url 'jobs:job_detail' application.job.id %}" class="btn-apply" style="text-decoration: none; display: inline-block;">View</a>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                            <i class="fas fa-briefcase" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                            <p>No jobs found. Start exploring opportunities!</p>
                            <a href="{% url 'jobs:job_list' %}" class="btn-apply" style="text-decoration: none; display: inline-block; margin-top: 1rem;">Browse Jobs</a>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h2><i class="fas fa-bolt"></i> Quick Actions</h2>
                </div>
                <div class="quick-actions">
                    <a href="{% url 'accounts:profile' %}" class="action-btn">
                        <i class="fas fa-user-edit"></i>
                        <span>Complete Profile</span>
                    </a>
                    <a href="{% url 'jobs:job_list' %}" class="action-btn">
                        <i class="fas fa-search"></i>
                        <span>Search Jobs</span>
                    </a>
                    <a href="{% url 'accounts:resume_builder' %}" class="action-btn">
                        <i class="fas fa-file-alt"></i>
                        <span>Resume Builder</span>
                    </a>
                    <a href="{% url 'education:course_list' %}" class="action-btn">
                        <i class="fas fa-book-open"></i>
                        <span>Explore Courses</span>
                    </a>
                    <a href="{% url 'accounts:profile_analytics' %}" class="action-btn">
                        <i class="fas fa-chart-bar"></i>
                        <span>View Analytics</span>
                    </a>
                    <a href="{% url 'accounts:profile_edit' %}" class="action-btn">
                        <i class="fas fa-user-edit"></i>
                        <span>Edit Profile</span>
                    </a>
                    <a href="#" class="action-btn">
                        <i class="fas fa-users"></i>
                        <span>Mentorship</span>
                    </a>
                </div>
            </div>

            <!-- Progress Chart -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h2><i class="fas fa-chart-line"></i> Career Progress</h2>
                </div>
                <div class="progress-chart">
                    <div class="progress-item">
                        <div class="progress-label">
                            <span>Profile Completion</span>
                            <span>{{ profile_completeness|floatformat:0|default:"0" }}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: {{ profile_completeness|default:"0" }}%"></div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <div class="progress-label">
                            <span>Skills Verified</span>
                            <span>72%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 72%"></div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <div class="progress-label">
                            <span>Course Completion</span>
                            <span>60%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 60%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="dashboard-card large">
                <div class="card-header">
                    <h2><i class="fas fa-clock"></i> Recent Activity</h2>
                </div>
                <div class="activity-list">
                    <div class="activity-item">
                        <div class="activity-icon success">
                            <i class="fas fa-check"></i>
                        </div>
                        <div class="activity-content">
                            <h4>Application Submitted</h4>
                            <p>Software Developer at TechCorp</p>
                            <span class="activity-time">2 hours ago</span>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-icon info">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="activity-content">
                            <h4>Course Enrolled</h4>
                            <p>Advanced Python Programming</p>
                            <span class="activity-time">1 day ago</span>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-icon warning">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="activity-content">
                            <h4>Profile Update Needed</h4>
                            <p>Add your resume to improve matches</p>
                            <span class="activity-time">2 days ago</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="{% static 'js/dashboard.js' %}"></script>
    <script src="{% static 'js/theme-switcher.js' %}"></script>
</body>
</html>

